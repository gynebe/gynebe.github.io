(()=>{var ne=Object.defineProperty;var O=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var A=(e,t,o)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,d=(e,t)=>{for(var o in t||(t={}))ie.call(t,o)&&A(e,o,t[o]);if(O)for(var o of O(t))le.call(t,o)&&A(e,o,t[o]);return e};var c=class{constructor(t=0,o="Network Error"){this.status=t,this.text=o}};var K=()=>{if(typeof localStorage!="undefined")return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}};var s={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:K()};var h=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{};var C=(e,t="https://api.emailjs.com")=>{if(!e)return;let o=h(e);s.publicKey=o.publicKey,s.blockHeadless=o.blockHeadless,s.storageProvider=o.storageProvider,s.blockList=o.blockList,s.limitRate=o.limitRate,s.origin=o.origin||t};var P=async(e,t,o={})=>{let a=await fetch(s.origin+e,{method:"POST",headers:o,body:t}),r=await a.text(),n=new c(a.status,r);if(a.ok)return n;throw n};var T=(e,t,o)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!o||typeof o!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"};var Y=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"};var D=e=>e.webdriver||!e.languages||e.languages.length===0;var x=()=>new c(451,"Unavailable For Headless Browser");var J=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"};var ce=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},me=(e,t)=>e instanceof FormData?e.get(t):e[t],R=(e,t)=>{if(ce(e))return!1;J(e.list,e.watchVariable);let o=me(t,e.watchVariable);return typeof o!="string"?!1:e.list.includes(o)};var j=()=>new c(403,"Forbidden");var N=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"};var de=async(e,t,o)=>{let a=Number(await o.get(e)||0);return t-Date.now()+a},H=async(e,t,o)=>{if(!t.throttle||!o)return!1;N(t.throttle,t.id);let a=t.id||e;return await de(a,t.throttle,o)>0?!0:(await o.set(a,Date.now().toString()),!1)};var B=()=>new c(429,"Too Many Requests");var W=async(e,t,o,a)=>{let r=h(a),n=r.publicKey||s.publicKey,p=r.blockHeadless||s.blockHeadless,L=r.storageProvider||s.storageProvider,y=d(d({},s.blockList),r.blockList),g=d(d({},s.limitRate),r.limitRate);return p&&D(navigator)?Promise.reject(x()):(T(n,e,t),Y(o),o&&R(y,o)?Promise.reject(j()):await H(location.pathname,g,L)?Promise.reject(B()):P("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:n,service_id:e,template_id:t,template_params:o}),{"Content-type":"application/json"}))};var z=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"};var ue=e=>typeof e=="string"?document.querySelector(e):e,U=async(e,t,o,a)=>{let r=h(a),n=r.publicKey||s.publicKey,p=r.blockHeadless||s.blockHeadless,L=s.storageProvider||r.storageProvider,y=d(d({},s.blockList),r.blockList),g=d(d({},s.limitRate),r.limitRate);if(p&&D(navigator))return Promise.reject(x());let l=ue(o);T(n,e,t),z(l);let i=new FormData(l);return R(y,i)?Promise.reject(j()):await H(location.pathname,g,L)?Promise.reject(B()):(i.append("lib_version","4.4.1"),i.append("service_id",e),i.append("template_id",t),i.append("user_id",n),P("/api/v1.0/email/send-form",i))};var M={init:C,send:W,sendForm:U,EmailJSResponseStatus:c};M.init("c0UqVFYtByUWzi-5c");var X={Porto:{1:{daySlots:{2:[{start:"10:20",end:"13:20"},{start:"15:00",end:"19:00"}],5:[{start:"10:20",end:"13:20"},{start:"15:00",end:"19:00"}]}},2:{daySlots:{2:[{start:"15:00",end:"18:00"}]}}},"Santo Tirso":{1:{daySlots:{1:[{start:"15:00",end:"19:00"}],3:[{start:"09:00",end:"12:40"}]}}}},m=0,G=document.documentElement.lang||"pt-PT",Z=document.querySelectorAll(".form-step"),f=document.getElementById("appointmentForm"),pe=document.getElementById("weekLabel"),Q=document.getElementById("calendarTable"),F=document.getElementById("selectedSlot"),V=f.elements.specialty,_=f.elements.location,S=new Date().getFullYear(),k=new Date().getMonth(),u=ee(new Date(S,k,1));function b(e){Z.forEach((t,o)=>t.classList.toggle("active",o===e))}window.nextStep=function(){let e=Z[m].querySelectorAll("input, select");for(let t of e)if(!t.checkValidity()){t.reportValidity();return}m++,b(m),E(u)};window.prevStep=function(){m--,b(m)};function ee(e){e=new Date(e);let t=e.getDay(),o=e.getDate()-t+(t===0?-6:1);return new Date(e.setDate(o))}function w(e,t){let[o,a]=t.split(":").map(Number),r=new Date(e);return r.setHours(o,a,0,0),r}function fe(e,t,o,a){let r=[],n=w(e,t),p=w(e,o);for(;n<=p;)r.push(new Date(n)),n=new Date(n.getTime()+a*6e4);return r}function E(e){var g;F.value="";let t=(g=X[_.value])==null?void 0:g[V.selectedIndex],o=document.querySelector(".calendar"),a=new Date(S,k,1),r=`${a.toLocaleString(G,{month:"long"})} ${a.getFullYear()}`;if(pe.innerHTML=`
        <div class="calendar-header">
            <button onclick="changeMonth(-1)">&lt;</button>
            <strong>${r}</strong>
            <button onclick="changeMonth(1)">&gt;</button>
        </div>
    `,!t||!t.daySlots){o.style.display="none",Q.innerHTML="";return}else o.style.display="block";let n=[...Array(5)].map((l,i)=>{let I=new Date(e);return I.setDate(e.getDate()+i),I}),p=n.map(l=>`<th>${l.toLocaleDateString(G,{weekday:"short",day:"numeric",month:"numeric"})}</th>`).join(""),y=fe(new Date,"09:00","19:00",20).map(l=>{let i=l.toTimeString().slice(0,5);return`<tr>${n.map(v=>{let te=v.getDay(),q=w(v,i),oe=(t.daySlots[te]||[]).some($=>{let ae=w(v,$.start),se=w(v,$.end);return q>=ae&&q<=se}),re=`${v.toLocaleDateString()} ${i}`;return`<td class="${oe?"slot":"disabled-slot"}" data-slot="${re}">${i}</td>`}).join("")}</tr>`});Q.innerHTML=`
        <table>
            <thead><tr>${p}</tr></thead>
            <tbody>${y.join("")}</tbody>
        </table>
    `,document.querySelectorAll(".slot").forEach(l=>{l.addEventListener("click",()=>{document.querySelectorAll(".slot").forEach(i=>i.classList.remove("selected")),l.classList.add("selected"),F.value=l.dataset.slot})})}V.addEventListener("change",()=>E(u));_.addEventListener("change",()=>E(u));window.changeWeek=function(e){u.setDate(u.getDate()+e*7),S=u.getFullYear(),k=u.getMonth(),E(u)};window.changeMonth=function(e){let t=new Date(S,k+e,1),o=t.getDay();o===6?t.setDate(t.getDate()+2):o===0&&t.setDate(t.getDate()+1),S=t.getFullYear(),k=t.getMonth(),u=ee(t),E(u)};f.addEventListener("submit",function(e){var a,r;if(e.preventDefault(),!F.value&&((a=X[f.elements.location.value])!=null&&a[f.elements.specialty.value])){alert("Por favor selecione um hor\xE1rio.");return}if(!grecaptcha.getResponse()){alert("Por favor confirma que n\xE3o \xE9s um rob\xF4.");return}let o={name:document.getElementById("name").value,email:document.getElementById("email").value,birthday:document.getElementById("birthday").value,contact:document.getElementById("contact").value,specialty:V.value,location:_.value,selectedSlot:F.value||"Sem hor\xE1rio selecionado",notes:((r=f.querySelector('[name="notes"]'))==null?void 0:r.value)||""};M.send("service_2mkemrj","template_yaezzgg",o).then(()=>{m=0,b(m),M.send("service_2mkemrj","template_ppny0sk",o).then(()=>{document.getElementById("statusMsg").textContent="Agendamento enviado com sucesso!",f.reset()}).catch(n=>{console.error("Erro no email do cliente:",n),document.getElementById("statusMsg").textContent="Erro ao enviar o e-mail de confirma\xE7\xE3o.",m=0,b(m)})}).catch(n=>{console.error("Erro no email da cl\xEDnica:",n),document.getElementById("statusMsg").textContent="Erro ao enviar. Tente novamente.",m=0,b(m)})});b(0);})();
