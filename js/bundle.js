(()=>{var Pe=Object.defineProperty,xe=Object.defineProperties;var Me=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var re=(e,t,o)=>t in e?Pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,m=(e,t)=>{for(var o in t||(t={}))Le.call(t,o)&&re(e,o,t[o]);if(oe)for(var o of oe(t))je.call(t,o)&&re(e,o,t[o]);return e},ne=(e,t)=>xe(e,Me(t));var d=class{constructor(t=0,o="Network Error"){this.status=t,this.text=o}};var ae=()=>{if(typeof localStorage!="undefined")return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}};var s={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:ae()};var D=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{};var se=(e,t="https://api.emailjs.com")=>{if(!e)return;let o=D(e);s.publicKey=o.publicKey,s.blockHeadless=o.blockHeadless,s.storageProvider=o.storageProvider,s.blockList=o.blockList,s.limitRate=o.limitRate,s.origin=o.origin||t};var F=async(e,t,o={})=>{let r=await fetch(s.origin+e,{method:"POST",headers:o,body:t}),a=await r.text(),n=new d(r.status,a);if(r.ok)return n;throw n};var I=(e,t,o)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!o||typeof o!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"};var ie=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"};var R=e=>e.webdriver||!e.languages||e.languages.length===0;var B=()=>new d(451,"Unavailable For Headless Browser");var le=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"};var Fe=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},Ie=(e,t)=>e instanceof FormData?e.get(t):e[t],H=(e,t)=>{if(Fe(e))return!1;le(e.list,e.watchVariable);let o=Ie(t,e.watchVariable);return typeof o!="string"?!1:e.list.includes(o)};var $=()=>new d(403,"Forbidden");var ce=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"};var Re=async(e,t,o)=>{let r=Number(await o.get(e)||0);return t-Date.now()+r},V=async(e,t,o)=>{if(!t.throttle||!o)return!1;ce(t.throttle,t.id);let r=t.id||e;return await Re(r,t.throttle,o)>0?!0:(await o.set(r,Date.now().toString()),!1)};var O=()=>new d(429,"Too Many Requests");var me=async(e,t,o,r)=>{let a=D(r),n=a.publicKey||s.publicKey,l=a.blockHeadless||s.blockHeadless,v=a.storageProvider||s.storageProvider,C=m(m({},s.blockList),a.blockList),k=m(m({},s.limitRate),a.limitRate);return l&&R(navigator)?Promise.reject(B()):(I(n,e,t),ie(o),o&&H(C,o)?Promise.reject($()):await V(location.pathname,k,v)?Promise.reject(O()):F("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:n,service_id:e,template_id:t,template_params:o}),{"Content-type":"application/json"}))};var de=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"};var Be=e=>typeof e=="string"?document.querySelector(e):e,ue=async(e,t,o,r)=>{let a=D(r),n=a.publicKey||s.publicKey,l=a.blockHeadless||s.blockHeadless,v=s.storageProvider||a.storageProvider,C=m(m({},s.blockList),a.blockList),k=m(m({},s.limitRate),a.limitRate);if(l&&R(navigator))return Promise.reject(B());let E=Be(o);I(n,e,t),de(E);let y=new FormData(E);return H(C,y)?Promise.reject($()):await V(location.pathname,k,v)?Promise.reject(O()):(y.append("lib_version","4.4.1"),y.append("service_id",e),y.append("template_id",t),y.append("user_id",n),F("/api/v1.0/email/send-form",y))};var q={init:se,send:me,sendForm:ue,EmailJSResponseStatus:d};q.init("c0UqVFYtByUWzi-5c");var pe={Porto:{1:{daySlots:{2:[{start:"12:00",end:"14:00"},{start:"15:00",end:"19:00"}],5:[{start:"9:00",end:"13:20"},{start:"15:00",end:"19:00"}]}}},"Santo Tirso":{1:{daySlots:{1:[{start:"15:00",end:"19:00"}],3:[{start:"09:00",end:"12:40",repeat:"biweekly",startDate:"2025-10-29"}]}}}},ge="2.2.7",Y={blockedDates:[],holidaysMessage:""},he=[],u=0,T=document.documentElement.lang||"pt-PT",ye=document.querySelectorAll(".form-step"),w=document.getElementById("appointmentForm"),He=document.getElementById("weekLabel"),fe=document.getElementById("calendarTable"),_=document.getElementById("selectedSlot"),h=w.elements.specialty,L=w.elements.location,A=new Date().getFullYear(),W=new Date().getMonth(),f=be(new Date);async function J(){try{let e=await fetch(`/calendar-rules.json?v=${ge}`,{cache:"no-store"});e.ok?Y=await e.json():console.error("Failed to load calendar rules:",e.status)}catch(e){console.error("Erro ao carregar regras do calend\xE1rio",e)}}async function z(){try{let e=await fetch(`/appointments.json?v=${ge}`,{cache:"no-store"});e.ok?he=await e.json():console.error("Failed to load appointments:",e.status)}catch(e){console.error("Erro ao carregar appointments.json",e)}}function U(e){return new Date(e)}function K(e,t){let[o,r]=t.split(":").map(Number);return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),o,r,0))}function $e(e,t,o,r){let a=[],n=K(e,t),l=K(e,o);for(;n<l;)a.push(new Date(n)),n=new Date(n.getTime()+r*6e4);return a}function be(e){e=new Date(e);let t=e.getUTCDay(),o=e.getUTCDate()-t+(t===0?-6:1);return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),o))}function Ve(e,t){let r=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())-Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());return Math.floor(r/6048e5)}function Oe(e,t){let o=e.repeat||"weekly";if(o==="weekly")return!0;if(o==="biweekly"&&e.startDate){let r=new Date(e.startDate+"T00:00:00Z");return Ve(r,t)%2===0&&t>=r}return o==="monthly"&&e.dayOfMonth?t.getUTCDate()===e.dayOfMonth:!0}function S(e){ye.forEach((t,o)=>t.classList.toggle("active",o===e))}window.nextStep=function(){let e=ye[u].querySelectorAll("input, select");for(let t of e)if(!t.checkValidity()){t.reportValidity();return}u++,S(u),j(f)};window.prevStep=function(){u--,S(u)};function j(e){var G;_.value="";let t=(G=pe[L.value])==null?void 0:G[h.selectedIndex],o=document.querySelector(".calendar"),r=new Date(Date.UTC(A,W,1)),a=`${r.toLocaleString(T,{month:"long"})} ${r.getUTCFullYear()}`;if(He.innerHTML=`
        <div class="calendar-header">
            <button onclick="changeMonth(-1)">&lt;</button>
            <strong>${a}</strong>
            <button onclick="changeMonth(1)">&gt;</button>
        </div>
    `,!t||!t.daySlots){o.style.display="none",fe.innerHTML="";return}else o.style.display="block";let n=null;L.value==="Porto"?h.selectedIndex===1?n=1:h.selectedIndex===2&&(n=2):L.value==="Santo Tirso"&&h.selectedIndex===1&&(n=4);let l=he.filter(i=>i.IdGabinete===n).map(i=>({start:U(i.DataInicio),end:U(i.DataFim)})),v=[...Array(5)].map((i,b)=>{let P=new Date(e);return P.setUTCDate(e.getUTCDate()+b),P}),C=new Date;C.setUTCHours(0,0,0,0);let k=new Date(C.getTime()+1440*60*1e3),E=v.map(i=>{let b=i<k,P=i.toLocaleDateString(T,{weekday:"short",day:"numeric",month:"numeric"});return`<th class="${b?"disabled-slot":""}">${P}</th>`}).join(""),y=h.selectedIndex===2?30:20,Te=$e(new Date,"09:00","19:00",y).map(i=>{let b=i.toISOString().substr(11,5);return`<tr>${v.map(p=>{var ee,te;let we=p.getUTCDay(),g=new Date(Date.UTC(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate(),i.getUTCHours(),i.getUTCMinutes())),Z=(t.daySlots[we]||[]).some(c=>{let Ue=K(p,c.start),Se=K(p,c.end),Ee=p.getUTCDay();return Oe(ne(m({},c),{day:Ee}),p)&&g>=Ue&&g<Se&&g>=k}),ve=((ee=Y.holidays)==null?void 0:ee[h.selectedIndex])||[],Ce=((te=Y.openExceptions)==null?void 0:te[h.selectedIndex])||[],Q=ve.some(c=>g>=U(c.DataInicio)&&g<U(c.DataFim)),x=Ce.some(c=>g>=U(c.DataInicio)&&g<U(c.DataFim)),X=l.some(c=>g>=c.start&&g<c.end&&(Z||x)),ke=(Z||x)&&!X&&!Q||x,De=`${p.toLocaleDateString()} ${b}`,N="disabled-slot",M="";return ke?N="slot":X?(N="booked-slot",M="Hor\xE1rio j\xE1 ocupado"):Q&&!x?M=Y.holidaysMessage:x&&(M="Aberto excecionalmente"),`<td class="${N}" data-slot="${De}" ${M?`title="${M}"`:""}>${b}</td>`}).join("")}</tr>`});fe.innerHTML=`
        <table>
            <thead><tr>${E}</tr></thead>
            <tbody>${Te.join("")}</tbody>
        </table>
    `,document.querySelectorAll(".slot").forEach(i=>{i.addEventListener("click",()=>{document.querySelectorAll(".slot").forEach(b=>b.classList.remove("selected")),i.classList.add("selected"),_.value=i.dataset.slot})})}h.addEventListener("change",()=>Promise.all([J(),z()]).then(()=>j(f)));L.addEventListener("change",()=>Promise.all([J(),z()]).then(()=>j(f)));window.changeWeek=async function(e){f.setUTCDate(f.getUTCDate()+e*7),A=f.getUTCFullYear(),W=f.getUTCMonth(),j(f)};window.changeMonth=function(e){let t=new Date(Date.UTC(A,W+e,1)),o=t.getUTCDay();o===6?t.setUTCDate(t.getUTCDate()+2):o===0&&t.setUTCDate(t.getUTCDate()+1),A=t.getUTCFullYear(),W=t.getUTCMonth(),f=be(t),j(f)};w.addEventListener("submit",function(e){var r,a;if(e.preventDefault(),!_.value&&((r=pe[w.elements.location.value])!=null&&r[w.elements.specialty.value])){alert("Por favor selecione um hor\xE1rio.");return}if(!grecaptcha.getResponse()){alert("Por favor confirma que n\xE3o \xE9s um rob\xF4.");return}let o={name:document.getElementById("name").value,email:document.getElementById("email").value,birthday:document.getElementById("birthday").value,contact:document.getElementById("contact").value,specialty:h.value,location:L.value,selectedSlot:_.value||"Sem hor\xE1rio selecionado",notes:((a=w.querySelector('[name="notes"]'))==null?void 0:a.value)||""};q.send("service_2mkemrj","template_yaezzgg",o).then(()=>{u=0,S(u),q.send("service_2mkemrj","template_ppny0sk",o).then(()=>{let n=document.getElementById("statusMsg");T==="en"?n.textContent="Appointment request successfully submitted! Pending confirmation.":T==="es"?n.textContent="\xA1Solicitud de cita enviada correctamente! Pendiente de confirmaci\xF3n.":n.textContent="Pedido de agendamento enviado com sucesso! Pendente de confirma\xE7\xE3o.",w.reset()}).catch(n=>{console.error("Erro no email do cliente:",n);let l=document.getElementById("statusMsg");T==="en"?l.textContent="Error sending confirmation email. Please try again.":T==="es"?l.textContent="Error al enviar el correo electr\xF3nico de confirmaci\xF3n. Por favor, int\xE9ntalo de nuevo.":l.textContent="Erro ao enviar o e-mail de confirma\xE7\xE3o. Por favor tente novamente.",u=0,S(u)})}).catch(n=>{console.error("Erro no email da cl\xEDnica:",n);let l=document.getElementById("statusMsg");T==="en"?l.textContent="Error sending email. Please try again.":T==="es"?l.textContent="Error al enviar el correo electr\xF3nico. Por favor, int\xE9ntalo de nuevo.":l.textContent="Erro ao enviar o e-mail. Por favor tente novamente.",u=0,S(u)})});(async()=>(await J(),await z(),S(0)))();})();
