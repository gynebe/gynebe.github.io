(()=>{var pe=Object.defineProperty;var N=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var J=(e,t,o)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,d=(e,t)=>{for(var o in t||(t={}))fe.call(t,o)&&J(e,o,t[o]);if(N)for(var o of N(t))ge.call(t,o)&&J(e,o,t[o]);return e};var l=class{constructor(t=0,o="Network Error"){this.status=t,this.text=o}};var W=()=>{if(typeof localStorage!="undefined")return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}};var s={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:W()};var y=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{};var z=(e,t="https://api.emailjs.com")=>{if(!e)return;let o=y(e);s.publicKey=o.publicKey,s.blockHeadless=o.blockHeadless,s.storageProvider=o.storageProvider,s.blockList=o.blockList,s.limitRate=o.limitRate,s.origin=o.origin||t};var L=async(e,t,o={})=>{let n=await fetch(s.origin+e,{method:"POST",headers:o,body:t}),r=await n.text(),a=new l(n.status,r);if(n.ok)return a;throw a};var x=(e,t,o)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!o||typeof o!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"};var U=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"};var T=e=>e.webdriver||!e.languages||e.languages.length===0;var B=()=>new l(451,"Unavailable For Headless Browser");var G=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"};var he=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},ye=(e,t)=>e instanceof FormData?e.get(t):e[t],M=(e,t)=>{if(he(e))return!1;G(e.list,e.watchVariable);let o=ye(t,e.watchVariable);return typeof o!="string"?!1:e.list.includes(o)};var R=()=>new l(403,"Forbidden");var Q=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"};var be=async(e,t,o)=>{let n=Number(await o.get(e)||0);return t-Date.now()+n},j=async(e,t,o)=>{if(!t.throttle||!o)return!1;Q(t.throttle,t.id);let n=t.id||e;return await be(n,t.throttle,o)>0?!0:(await o.set(n,Date.now().toString()),!1)};var I=()=>new l(429,"Too Many Requests");var X=async(e,t,o,n)=>{let r=y(n),a=r.publicKey||s.publicKey,m=r.blockHeadless||s.blockHeadless,v=r.storageProvider||s.storageProvider,P=d(d({},s.blockList),r.blockList),w=d(d({},s.limitRate),r.limitRate);return m&&T(navigator)?Promise.reject(B()):(x(a,e,t),U(o),o&&M(P,o)?Promise.reject(R()):await j(location.pathname,w,v)?Promise.reject(I()):L("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:a,service_id:e,template_id:t,template_params:o}),{"Content-type":"application/json"}))};var Z=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"};var ve=e=>typeof e=="string"?document.querySelector(e):e,ee=async(e,t,o,n)=>{let r=y(n),a=r.publicKey||s.publicKey,m=r.blockHeadless||s.blockHeadless,v=s.storageProvider||r.storageProvider,P=d(d({},s.blockList),r.blockList),w=d(d({},s.limitRate),r.limitRate);if(m&&T(navigator))return Promise.reject(B());let g=ve(o);x(a,e,t),Z(g);let i=new FormData(g);return M(P,i)?Promise.reject(R()):await j(location.pathname,w,v)?Promise.reject(I()):(i.append("lib_version","4.4.1"),i.append("service_id",e),i.append("template_id",t),i.append("user_id",a),L("/api/v1.0/email/send-form",i))};var H={init:z,send:X,sendForm:ee,EmailJSResponseStatus:l};H.init("c0UqVFYtByUWzi-5c");var re={Porto:{1:{daySlots:{2:[{start:"10:20",end:"13:20"},{start:"15:00",end:"19:00"}],5:[{start:"10:20",end:"13:20"},{start:"15:00",end:"19:00"}]}},2:{daySlots:{2:[{start:"15:00",end:"18:00"}]}}},"Santo Tirso":{1:{daySlots:{1:[{start:"15:00",end:"19:00"}],3:[{start:"09:00",end:"12:40"}]}}}},we="2.2.7",_={blockedDates:[],holidaysMessage:""},c=0,te=document.documentElement.lang||"pt-PT",ne=document.querySelectorAll(".form-step"),f=document.getElementById("appointmentForm"),Ee=document.getElementById("weekLabel"),oe=document.getElementById("calendarTable"),F=document.getElementById("selectedSlot"),V=f.elements.specialty,O=f.elements.location,$=new Date().getFullYear(),q=new Date().getMonth(),u=ae(new Date);async function se(){try{let e=await fetch(`/calendar-rules.json?v=${we}`,{cache:"no-store"});e.ok?_=await e.json():console.error("Failed to load calendar rules:",e.status)}catch(e){console.error("Erro ao carregar regras do calend\xE1rio",e)}}function b(e){ne.forEach((t,o)=>t.classList.toggle("active",o===e))}window.nextStep=function(){let e=ne[c].querySelectorAll("input, select");for(let t of e)if(!t.checkValidity()){t.reportValidity();return}c++,b(c),k(u)};window.prevStep=function(){c--,b(c)};function ae(e){e=new Date(e);let t=e.getDay(),o=e.getDate()-t+(t===0?-6:1);return new Date(e.setDate(o))}function S(e,t){let[o,n]=t.split(":").map(Number),r=new Date(e);return r.setHours(o,n,0,0),r}function Se(e,t,o,n){let r=[],a=S(e,t),m=S(e,o);for(;a<=m;)r.push(new Date(a)),a=new Date(a.getTime()+n*6e4);return r}function k(e){var g;F.value="";let t=(g=re[O.value])==null?void 0:g[V.selectedIndex],o=document.querySelector(".calendar"),n=new Date($,q,1),r=`${n.toLocaleString(te,{month:"long"})} ${n.getFullYear()}`;if(Ee.innerHTML=`
        <div class="calendar-header">
            <button onclick="changeMonth(-1)">&lt;</button>
            <strong>${r}</strong>
            <button onclick="changeMonth(1)">&gt;</button>
        </div>
    `,!t||!t.daySlots){o.style.display="none",oe.innerHTML="";return}else o.style.display="block";let a=[...Array(5)].map((i,p)=>{let E=new Date(e);return E.setDate(e.getDate()+p),E}),m=new Date;m.setHours(0,0,0,0),m.setDate(m.getDate()+1);let v=a.map(i=>{let p=i<m,E=i.toLocaleDateString(te,{weekday:"short",day:"numeric",month:"numeric"});return`<th class="${p?"disabled-slot":""}">${E}</th>`}).join(""),w=Se(new Date,"09:00","19:00",20).map(i=>{let p=i.toTimeString().slice(0,5);return`<tr>${a.map(h=>{var K;let ie=h.getDay(),C=S(h,p),le=t.daySlots[ie]||[],D=new Date;D.setHours(0,0,0,0),D.setDate(D.getDate()+1);let A=(((K=_.holidays)==null?void 0:K[V.selectedIndex])||[]).includes(h.toISOString().split("T")[0]),ce=le.some(Y=>{let de=S(h,Y.start),ue=S(h,Y.end);return C>=de&&C<=ue&&C>=D})&&!A,me=`${h.toLocaleDateString()} ${p}`;return`<td class="${ce?"slot":"disabled-slot"}" 
                    data-slot="${me}" 
                    ${A?`title="${_.holidaysMessage}"`:""}>
                    ${p} </td>`}).join("")}</tr>`});oe.innerHTML=`
        <table>
            <thead><tr>${v}</tr></thead>
            <tbody>${w.join("")}</tbody>
        </table>
    `,document.querySelectorAll(".slot").forEach(i=>{i.addEventListener("click",()=>{document.querySelectorAll(".slot").forEach(p=>p.classList.remove("selected")),i.classList.add("selected"),F.value=i.dataset.slot})})}V.addEventListener("change",()=>se().then(()=>k(u)));O.addEventListener("change",()=>se().then(()=>k(u)));window.changeWeek=function(e){u.setDate(u.getDate()+e*7),$=u.getFullYear(),q=u.getMonth(),k(u)};window.changeMonth=function(e){let t=new Date($,q+e,1),o=t.getDay();o===6?t.setDate(t.getDate()+2):o===0&&t.setDate(t.getDate()+1),$=t.getFullYear(),q=t.getMonth(),u=ae(t),k(u)};f.addEventListener("submit",function(e){var n,r;if(e.preventDefault(),!F.value&&((n=re[f.elements.location.value])!=null&&n[f.elements.specialty.value])){alert("Por favor selecione um hor\xE1rio.");return}if(!grecaptcha.getResponse()){alert("Por favor confirma que n\xE3o \xE9s um rob\xF4.");return}let o={name:document.getElementById("name").value,email:document.getElementById("email").value,birthday:document.getElementById("birthday").value,contact:document.getElementById("contact").value,specialty:V.value,location:O.value,selectedSlot:F.value||"Sem hor\xE1rio selecionado",notes:((r=f.querySelector('[name="notes"]'))==null?void 0:r.value)||""};H.send("service_2mkemrj","template_yaezzgg",o).then(()=>{c=0,b(c),H.send("service_2mkemrj","template_ppny0sk",o).then(()=>{document.documentElement.lang=="en"?document.getElementById("statusMsg").textContent="Appointment request successfully submitted! Pending confirmation.":document.documentElement.lang=="es"?document.getElementById("statusMsg").textContent="\xA1Solicitud de cita enviada correctamente! Pendiente de confirmaci\xF3n.":document.getElementById("statusMsg").textContent="Pedido de agendamento enviado com sucesso! Pendente de confirma\xE7\xE3o.",f.reset()}).catch(a=>{console.error("Erro no email do cliente:",a),document.documentElement.lang=="en"?document.getElementById("statusMsg").textContent="Error sending confirmation email. Please try again.":document.documentElement.lang=="es"?document.getElementById("statusMsg").textContent="Error al enviar el correo electr\xF3nico de confirmaci\xF3n. Por favor, int\xE9ntalo de nuevo.":document.getElementById("statusMsg").textContent="Erro ao enviar o e-mail de confirma\xE7\xE3o. Por favor tente novamente.",c=0,b(c)})}).catch(a=>{console.error("Erro no email da cl\xEDnica:",a),document.documentElement.lang=="en"?document.getElementById("statusMsg").textContent="Error sending email. Please try again.":document.documentElement.lang=="es"?document.getElementById("statusMsg").textContent="Error al enviar el correo electr\xF3nico. Por favor, int\xE9ntalo de nuevo.":document.getElementById("statusMsg").textContent="Erro ao enviar o e-mail. Por favor tente novamente.",c=0,b(c)})});b(0);})();
